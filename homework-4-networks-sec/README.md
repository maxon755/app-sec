# Homework 4. Network Security

Setup:

- Working machine: Kali Linux VM
- Target machine: [Metasploitable2](https://sourceforge.net/projects/metasploitable/files/Metasploitable2/)

The machines are connected via bridge network

## Task 1. Server ports scanning

The target machine ports are scanned via `nmap -sV`

The result of scanning:

| PORT     | STATE | SERVICE    | VERSION                                      |
| -------- | ----- | ---------- | -------------------------------------------- |
| 21/tcp   | open  | ftp        | vsftpd 2.3.4                                 |
| 22/tcp   | open  | ssh        | OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0) |
| 80/tcp   | open  | http       | Apache httpd 2.2.8 ((Ubuntu) DAV/2)          |
| 2121/tcp | open  | ftp        | ProFTPD 1.3.1                                |
| 3306/tcp | open  | mysql      | MySQL 5.0.51a-3ubuntu5                       |
| 5432/tcp | open  | postgresql | PostgreSQL DB 8.3.0 - 8.3.7                  |
| 8180/tcp | open  | http       | Apache Tomcat/Coyote JSP engine 1.1          |

## Task 2. Wireshark

The expression for filtering traffic by word `robot`:

```bash
fragment contains "robot"
```

Since the connection of `https://robotdreams.cc` we can't filter site content. But there are some DNS and TLS handshake packets:
![alt text](filtered_packets.png)

The packet content that contains word "robot":
![alt text](packet_content.png)

### TLS decryption

One of the ways of TLS decryption in WireShark is (Pre)-Master-Secret
that can be generated by browser.  
Using this [guide](https://wiki.wireshark.org/TLS#using-the-pre-master-secret)
I've managed to see `HTTP` packets:
![alt text](http_packets.png)

Even though WireShark allows to inspect decrypted and decompressed content (gzipped), there is no way to filter by it.
![alt text](decomressed_packet.png)

## Task 3. DNS Records analysis

The DNS records for `pentest-ground.com`:

| Type | Hostname                      | IP Address     |
| ---- | ----------------------------- | -------------- |
| A    | pentest-ground.com            | 178.79.134.182 |
| A    | playground.pentest-ground.com | 70.34.253.159  |
| MX   | mail.pentest-ground.com       | 192.248.188.61 |
| SOA  | ns1.linode.com                | 92.123.94.2    |
| SOA  | ns1.linode.com                | 2600:14c0:6::2 |
| NS   | ns3.linode.com                | 92.123.95.3    |
| NS   | ns3.linode.com                | 2600:14c0:7::3 |
| NS   | ns1.linode.com                | 92.123.94.2    |
| NS   | ns1.linode.com                | 2600:14c0:6::2 |
| NS   | ns2.linode.com                | 92.123.94.3    |
| NS   | ns2.linode.com                | 2600:14c0:6::3 |
| NS   | ns5.linode.com                | 92.123.95.2    |
| NS   | ns5.linode.com                | 2600:14c0:7::2 |
| NS   | ns4.linode.com                | 92.123.95.4    |
| NS   | ns4.linode.com                | 2600:14c0:7::4 |
